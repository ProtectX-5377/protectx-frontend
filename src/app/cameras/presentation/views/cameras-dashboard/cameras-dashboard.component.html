<div class="cameras-dashboard">
  <header class="dashboard-header">
    <h1>{{ 'CAMERAS.TITLE' | translate }}</h1>
    <p>{{ 'CAMERAS.SUBTITLE' | translate }}</p>
  </header>

  <!-- Loading State -->
  @if (loading()) {
    <div class="loading">
      {{ 'COMMON.LOADING' | translate }}
    </div>
  }

  <!-- Cameras Grid -->
  @if (!loading()) {
    <div class="cameras-grid">
      @for (camera of cameras(); track camera.id) {
        <div class="camera-card">
          <div class="camera-header">
            <span class="status-indicator" [class]="camera.status"></span>
            <h3>{{ camera.name }}</h3>
            <span class="status-icon">{{ getStatusIcon(camera) }}</span>
          </div>

          <div class="camera-preview">
            <div class="video-placeholder">
              @if (camera.status === 'offline') {
                <span class="offline-message">
                  {{ 'CAMERAS.OFFLINE' | translate }}
                </span>
              }
              @if (camera.status === 'recording') {
                <span class="recording-indicator">
                  üî¥ {{ 'CAMERAS.RECORDING' | translate }}
                </span>
              }
            </div>
          </div>

          <div class="camera-info">
            <div class="info-row">
              <span class="label">{{ 'CAMERAS.RESOLUTION' | translate }}:</span>
              <span class="value">{{ camera.resolution }}</span>
            </div>
            <div class="info-row">
              <span class="label">{{ 'CAMERAS.NIGHT_VISION' | translate }}:</span>
              <span class="value">{{ camera.nightVision ? 'ON' : 'OFF' }}</span>
            </div>
            <div class="info-row">
              <span class="label">{{ 'CAMERAS.MOTION_DETECTION' | translate }}:</span>
              <span class="value">{{ camera.motionDetection ? 'ACTIVE' : 'INACTIVE' }}</span>
            </div>
          </div>

          <div class="camera-actions">
            <button
              class="btn-config"
              [routerLink]="['/cameras', camera.id, 'config']">
              ‚öôÔ∏è {{ 'CAMERAS.CONFIGURE' | translate }}
            </button>
          </div>
        </div>
      }
    </div>
  }

  <!-- Empty State -->
  @if (!loading() && cameras().length === 0) {
    <div class="empty-state">
      <h3>{{ 'CAMERAS.NO_CAMERAS' | translate }}</h3>
      <p>{{ 'CAMERAS.ADD_FIRST_CAMERA' | translate }}</p>
      <button class="btn-primary">{{ 'CAMERAS.ADD_CAMERA' | translate }}</button>
    </div>
  }

  <!-- Bot√≥n para abrir/cerrar formulario -->
  <div class="add-camera-container">
    <button class="btn-primary" (click)="toggleForm()">
      {{ formVisible() ? ('common.cancel' | translate) : ('CAMERAS.ADD_CAMERA' | translate) }}
    </button>
  </div>

  <!-- Formulario embebido -->
  @if (formVisible()) {
    <div class="camera-form-container">
      <h2>{{ 'CAMERAS.NEW_CAMERA' | translate }}</h2>

      <form (ngSubmit)="submitForm()" class="camera-form" #form="ngForm">

        <label>
          {{ 'CAMERAS.NAME' | translate }}:
          <input type="text" required [(ngModel)]="newCameraForm().name" name="name" #name="ngModel">
        </label>

        <label>
          {{ 'CAMERAS.STATUS' | translate }}:
          <select [(ngModel)]="newCameraForm().status" name="status">
            <option value="online">Online</option>
            <option value="offline">Offline</option>
            <option value="recording">Recording</option>
          </select>
        </label>

        <label>
          {{ 'CAMERAS.RESOLUTION' | translate }}:
          <select [(ngModel)]="newCameraForm().resolution" name="resolution">
            <option value="high">High</option>
            <option value="low">Low</option>
          </select>
        </label>

        <label>
          {{ 'CAMERAS.NIGHT_VISION' | translate }}:
          <input type="checkbox" [(ngModel)]="newCameraForm().nightVision" name="nightVision">
        </label>

        <label>
          {{ 'CAMERAS.MOTION_DETECTION' | translate }}:
          <input type="checkbox" [(ngModel)]="newCameraForm().motionDetection" name="motionDetection">
        </label>

        <label>
          {{ 'CAMERAS.LOCATION' | translate }}:
          <input type="text" [(ngModel)]="newCameraForm().location" name="location">
        </label>

        <label>
          {{ 'CAMERAS.STREAM_URL' | translate }}:
          <input type="text" [(ngModel)]="newCameraForm().streamUrl" name="streamUrl">
        </label>

        <button type="submit" class="btn-save" [disabled]="form.invalid">
          {{ 'common.save' | translate }}
        </button>

      </form>
    </div>
  }

</div>
